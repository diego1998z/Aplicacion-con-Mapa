#map{
    width:100%;
    height:100vh;
    position:relative;
}

.leaflet-control-container .leaflet-top.leaflet-left{
    margin-top:190px;
    margin-left:12px;
}

.map-floating-controls{
    position:fixed;
    top:16px;
    left:20px;
    z-index:1600;
    display:flex;
    flex-direction:column;
    gap:10px;
    pointer-events:auto;
}
.map-floating-controls{align-items:flex-start;}
body.dash-shell .map-floating-controls{
    left:300px;
}

/* Flujo Agregar / Registrar */
.registro-hint{
    position:fixed;
    top:86px;
    left:50%;
    transform:translateX(-50%);
    z-index:2600;
    background:var(--panel-glass-strong);
    border:1px solid var(--border);
    border-radius:999px;
    padding:10px 14px;
    box-shadow:var(--shadow);
    font-weight:800;
    color:var(--text);
    pointer-events:none;
}
body.dash-shell .registro-hint{
    left:calc(50% + 140px);
}
.registro-hint.hidden{display:none;}

.registro-picker{
    position:fixed;
    inset:0;
    z-index:2600;
    display:grid;
    place-items:center;
    pointer-events:auto;
    background:rgba(15,23,42,0.06);
}
.registro-picker.hidden{display:none;}
.registro-picker-card{
    pointer-events:auto;
    width:min(560px, calc(100vw - 24px));
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:22px;
    box-shadow:0 26px 70px rgba(0,0,0,0.22);
    padding:18px 18px 14px;
}
body.dash-shell .registro-picker-card{
    margin-left:140px;
}
.registro-picker-title{
    font-weight:900;
    font-size:18px;
    color:var(--text);
    text-align:center;
    margin:2px 0 14px;
}
.registro-picker-grid{
    display:grid;
    grid-template-columns:repeat(4, 1fr);
    gap:12px;
}
.registro-picker-option{
    border:1px solid rgba(11,34,48,0.18);
    background:#fff;
    border-radius:16px;
    padding:14px 10px;
    display:grid;
    justify-items:center;
    gap:10px;
    cursor:pointer;
    transition:transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease;
    min-height:92px;
}
.registro-picker-option:hover{
    transform:translateY(-1px);
    box-shadow:0 10px 24px rgba(17,38,62,0.12);
    border-color:rgba(29,112,184,0.35);
}
.registro-picker-option.active{
    background:#0c426a;
    border-color:#0c426a;
    color:#fff;
}
.registro-opt-icon{
    width:26px;
    height:26px;
    border-radius:12px;
    background:#eef2f8;
    border:1px solid rgba(11,34,48,0.10);
    background-repeat:no-repeat;
    background-position:center;
    background-size:60%;
}
.registro-picker-option.active .registro-opt-icon{
    background:rgba(255,255,255,0.14);
    border-color:rgba(255,255,255,0.22);
    filter:brightness(1.15);
}
.registro-opt-icon--transito{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230c426a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 2l8 10-8 10L4 12 12 2z'/></svg>");
}
.registro-picker-option.active .registro-opt-icon--transito{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 2l8 10-8 10L4 12 12 2z'/></svg>");
}
.registro-opt-icon--marcas{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230c426a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M5 12h14'/></svg>");
}
.registro-picker-option.active .registro-opt-icon--marcas{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M5 12h14'/></svg>");
}
.registro-opt-icon--mobiliario{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230c426a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M7 10h10'/><path d='M8 10l-2 9'/><path d='M16 10l2 9'/><path d='M8 14h8'/></svg>");
}
.registro-picker-option.active .registro-opt-icon--mobiliario{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M7 10h10'/><path d='M8 10l-2 9'/><path d='M16 10l2 9'/><path d='M8 14h8'/></svg>");
}
.registro-opt-icon--eventos{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230c426a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 3l10 18H2L12 3z'/></svg>");
}
.registro-picker-option.active .registro-opt-icon--eventos{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 3l10 18H2L12 3z'/></svg>");
}
.registro-opt-text{
    font-weight:900;
    font-size:13px;
    line-height:1.1;
    text-align:center;
    color:inherit;
}
.registro-picker-cancel{
    margin:14px auto 0;
    display:block;
    border:none;
    background:transparent;
    color:var(--muted);
    font-weight:800;
    cursor:pointer;
    padding:8px 10px;
}
.registro-picker-cancel:hover{color:var(--text);}

.registro-panel{
    position:fixed;
    top:120px;
    right:22px;
    width:360px;
    max-height:calc(100vh - 160px);
    overflow:hidden;
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:22px;
    box-shadow:0 24px 70px rgba(0,0,0,0.22);
    z-index:2600;
}
.registro-panel.hidden{display:none;}
.registro-panel-head{
    background:#0c426a;
    color:#fff;
    padding:12px 14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
}
.registro-panel-title{
    font-weight:900;
    font-size:16px;
    display:flex;
    align-items:center;
    gap:10px;
}
.registro-panel-close{
    border:none;
    background:rgba(255,255,255,0.12);
    color:#fff;
    width:34px;
    height:34px;
    border-radius:10px;
    cursor:pointer;
    display:grid;
    place-items:center;
    font-size:18px;
    line-height:1;
}
.registro-panel-close:hover{background:rgba(255,255,255,0.18);}
.registro-panel-body{
    padding:14px 14px 18px;
    overflow:auto;
    max-height:calc(100vh - 220px);
}
.registro-panel .icon-grid{
    max-height:none;
    overflow-y:visible;
}
.registro-field{
    display:flex;
    flex-direction:column;
    gap:6px;
    margin-bottom:12px;
}
.registro-label{
    font-weight:900;
    color:var(--text);
}
.registro-input{
    width:100%;
    padding:10px 12px;
    border-radius:999px;
    border:1px solid rgba(11,34,48,0.22);
    background:#fff;
    outline:none;
}
.registro-input:focus{
    border-color:var(--primary);
    box-shadow:0 0 0 3px rgba(29,112,184,0.14);
}
.registro-cat-grid{
    display:grid;
    grid-template-columns:repeat(3, 1fr);
    gap:10px;
    margin-top:10px;
}
.registro-cat{
    border:1px solid rgba(11,34,48,0.22);
    background:#fff;
    border-radius:14px;
    padding:10px 10px;
    display:grid;
    justify-items:center;
    gap:6px;
    cursor:pointer;
    font-weight:900;
    font-size:12px;
    color:var(--text);
}
.registro-cat.active{
    border-color:var(--primary);
    box-shadow:0 10px 22px rgba(29,112,184,0.16);
}
.registro-cat-icon{
    width:34px;
    height:34px;
    border-radius:12px;
    background:#eef2f8;
    border:1px solid rgba(11,34,48,0.10);
    background-repeat:no-repeat;
    background-position:center;
    background-size:64%;
}
.registro-cat-icon--preventiva{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23f7a800'><path d='M12 2l8 10-8 10L4 12 12 2z'/></svg>");}
.registro-cat-icon--reglamentaria{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d93f3f'><circle cx='12' cy='12' r='9'/></svg>");}
.registro-cat-icon--informativa{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232fa84f'><rect x='5' y='5' width='14' height='14' rx='3'/></svg>");}

.registro-dim-row{
    display:flex;
    align-items:center;
    gap:10px;
}
.registro-dim-row .registro-input{
    border-radius:999px;
}
.registro-dim-x{
    font-weight:900;
    color:var(--muted);
}
.registro-pill-row{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
}
.registro-pill{
    border:1px solid rgba(11,34,48,0.22);
    background:#fff;
    border-radius:999px;
    padding:8px 12px;
    font-weight:900;
    cursor:pointer;
    color:var(--text);
}
.registro-pill.active{
    border-color:var(--primary);
    color:var(--primary);
    background:rgba(29,112,184,0.10);
}
.registro-pill--ok.active{background:#2fa84f;color:#053019;border-color:#2fa84f;}
.registro-pill--warn.active{background:#d93f3f;color:#fff;border-color:#d93f3f;}
.registro-pill--bad.active{background:#3f7ed9;color:#fff;border-color:#3f7ed9;}
.registro-pill-sub{
    display:block;
    font-size:10px;
    opacity:0.85;
    font-weight:800;
}
.registro-upload{
    display:flex;
    flex-direction:column;
    gap:8px;
}
.registro-upload-btn{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding:10px 12px;
    border-radius:12px;
    border:1px solid rgba(11,34,48,0.22);
    background:#eef2f8;
    cursor:pointer;
    font-weight:900;
    color:#0c426a;
}
.registro-upload-btn svg{width:18px;height:18px;}
.registro-help{
    margin-top:2px;
    font-size:12px;
    color:var(--muted);
}
.registro-submit{
    width:100%;
    margin-top:10px;
    border:1px solid rgba(11,34,48,0.22);
    background:#e6f6fb;
    color:#0c426a;
    padding:12px 14px;
    border-radius:999px;
    font-weight:900;
    cursor:pointer;
}
.registro-submit:hover{filter:brightness(1.03);}
.registro-submit:disabled{
    opacity:0.55;
    cursor:not-allowed;
}

/* Pin temporal de registro */
.registro-pin-icon{
    width:22px;
    height:22px;
    border-radius:50%;
    background:#21c8d4;
    border:3px solid #ffffff;
    box-shadow:0 14px 26px rgba(0,0,0,0.22);
    position:relative;
}
.registro-pin-icon:after{
    content:"";
    position:absolute;
    left:50%;
    bottom:-10px;
    width:0;
    height:0;
    transform:translateX(-50%);
    border-left:7px solid transparent;
    border-right:7px solid transparent;
    border-top:12px solid #21c8d4;
    filter:drop-shadow(0 6px 10px rgba(0,0,0,0.18));
}

@media (max-width: 900px){
    body.dash-shell .registro-picker-card{margin-left:0;}
    body.dash-shell .registro-hint{left:50%;}
}
@media (max-width: 600px){
    .registro-picker-grid{grid-template-columns:repeat(2, 1fr);}
    .registro-panel{
        left:12px;
        right:12px;
        top:auto;
        bottom:12px;
        width:auto;
        max-height:78vh;
    }
    .registro-panel-body{max-height:calc(78vh - 54px);}
}
.map-floating-row{
    display:flex;
    gap:10px;
}
.map-floating-search{
    position:relative;
    width:min(520px, calc(100vw - 40px));
    display:flex;
    align-items:center;
    gap:10px;
    padding:10px 12px;
    background:var(--panel-glass-strong);
    border:1px solid var(--border);
    border-radius:999px;
    box-shadow:var(--shadow);
    margin:0;
}
.map-floating-search input{
    flex:1;
    height:38px;
    border:none;
    outline:none;
    background:transparent;
    color:var(--text);
    margin:0;
    padding:0 6px;
}
.map-floating-search .btnBuscar{
    width:auto !important;
    margin:0 !important;
    padding:10px 14px !important;
    border-radius:999px !important;
}
.map-floating-search .sugerencias{
    position:absolute;
    top:calc(100% + 10px);
    left:0;
    right:0;
    margin-top:0;
}
.map-floating-actions{
    display:flex;
    gap:10px;
}
.map-floating-btn{
    padding:10px 14px;
    border-radius:999px;
    border:1px solid var(--border);
    background:var(--panel-glass-strong);
    color:var(--text);
    font-weight:800;
    cursor:pointer;
    box-shadow:var(--shadow);
}
.map-floating-btn--dark{
    background:#0c426a;
    border-color:rgba(11,34,48,0.28);
    color:#fff;
}
.map-floating-btn--dark:hover{filter:brightness(1.03);}
.map-floating-btn--dark.active{
    background:#0c426a;
    color:#fff;
    border-color:rgba(255,255,255,0.35);
}
.map-floating-btn:hover:not(.map-floating-btn--dark){
    filter:brightness(1.02);
}
.map-floating-btn.active:not(.map-floating-btn--dark){
    border-color:var(--primary);
    color:var(--primary);
    background:rgba(29,112,184,0.10);
}

.map-floating-panel{
    width:280px;
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:20px;
    box-shadow:0 18px 46px rgba(0,0,0,0.18);
    padding:12px 12px 14px;
}
.map-floating-panel.hidden{display:none;}
.map-panel-section{
    display:flex;
    flex-direction:column;
    gap:10px;
    padding:6px 4px 10px;
}
.map-panel-group{
    margin-top:12px;
    padding-top:10px;
    border-top:1px solid var(--border);
    display:flex;
    flex-direction:column;
    gap:10px;
}
.map-panel-title{
    font-weight:900;
    font-size:12px;
    color:var(--muted);
    margin-bottom:2px;
}
.map-panel-check{
    display:flex;
    align-items:center;
    gap:10px;
    font-weight:800;
    color:var(--text);
    user-select:none;
}
.map-panel-check input{
    width:16px;
    height:16px;
    accent-color:var(--primary);
}
.map-panel-btn{
    width:100%;
    padding:10px 12px;
    border-radius:999px;
    border:1px solid rgba(11,34,48,0.18);
    background:#0c426a;
    color:#fff;
    font-weight:900;
    cursor:pointer;
    margin-top:8px;
}
.map-panel-btn:hover{filter:brightness(1.03);}
.map-panel-btn--ghost{
    background:var(--bg);
    color:var(--primary-dark);
    border-color:rgba(29,112,184,0.22);
}
.map-panel-advanced{
    margin-top:6px;
}
.map-floating-btn--primary{
    background:var(--panel);
    border-color:rgba(29,112,184,0.22);
    color:var(--primary-dark);
}
.map-floating-btn--primary .plus{
    font-weight:900;
    margin-right:6px;
}

/* Ya no usamos el buscador mobile (se reemplaza por el flotante) */
#mobileSearch{
    display:none !important;
}

.legend{
    position:absolute;
    bottom:24px;
    right:24px;
    background:var(--panel-glass-strong);
    border:1px solid var(--border);
    border-radius:12px;
    padding:14px 16px;
    box-shadow:var(--shadow);
    min-width:140px;
    font-size:13px;
    z-index:1300;
    pointer-events:none;
}
.legend-title{
    font-weight:700;
    margin-bottom:8px;
    color:var(--text);
}
.legend-item{
    display:flex;
    align-items:center;
    gap:8px;
    color:var(--muted);
    margin-bottom:6px;
}
.legend-item:last-child{margin-bottom:0;}
.dot{
    width:12px;
    height:12px;
    border-radius:50%;
    display:inline-block;
}
.dot-new{background:#2fa84f;}
.dot-bad{background:#d93f3f;}
.dot-missing{background:#3f7ed9;}

.estado-marker{filter:drop-shadow(0 8px 14px rgba(0,0,0,0.18));}
.marker-bubble{
    width:38px;
    height:38px;
    border-radius:50%;
    border:3px solid #2fa84f;
    background:#fff;
    display:grid;
    place-items:center;
}
.marker-img{
    width:26px;
    height:26px;
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
}

.popup-crear{
    min-width:300px;
    font-size:13px;
    color:#1f2d3d;
    padding:0;
    background:transparent;
    border:none;
    border-radius:0;
    box-shadow:none;
}
.popup-tabs{
    display:flex;
    gap:6px;
    margin-bottom:8px;
}
.popup-tabs .tab-btn{
    flex:1;
    border:1px solid #e5e9f2;
    background:#f5f7fb;
    border-radius:8px;
    padding:6px;
    cursor:pointer;
    font-weight:600;
}
.popup-tabs .tab-btn.active{
    background:#1d70b8;
    border-color:#1d70b8;
    color:#fff;
}
.popup-tabs .tab-btn.disabled{
    opacity:0.5;
    pointer-events:none;
}
.tab-panel{display:none;}
.tab-panel.active{display:block;}
.estado-grid,.icon-grid{
    display:grid;
    gap:8px;
}
.estado-grid{
    grid-template-columns:repeat(3,1fr);
}
.estado-option{
    border:1px solid #e5e9f2;
    border-radius:8px;
    padding:8px 6px;
    background:#fff;
    cursor:pointer;
    font-weight:600;
}
.estado-option.active{
    border-color:#1d70b8;
    color:#1d70b8;
    background:rgba(29,112,184,0.08);
}
.step{
    margin-bottom:10px;
    border:none;
    border-radius:12px;
    padding:8px 0 0 0;
    background:transparent;
    box-shadow:none;
}
.step.collapsed{
    opacity:0.8;
    transform:scale(0.99);
    transition:transform 120ms ease, opacity 120ms ease;
}
.step-title{
    font-weight:700;
    margin-bottom:6px;
    color:var(--text);
}
.fecha-row{
    margin-top:10px;
    font-size:12px;
    color:var(--muted);
    display:flex;
    flex-direction:column;
    gap:4px;
}
.fecha-row input{
    padding:8px 10px;
    border-radius:8px;
    border:1px solid var(--border);
}
.precio-row{
    margin-top:10px;
    font-size:12px;
    color:var(--muted);
    display:flex;
    flex-direction:column;
    gap:4px;
}
.precio-input{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    border-radius:10px;
    border:1px solid var(--border);
    background:#fff;
}
.precio-input span{
    color:var(--muted);
    font-weight:800;
}
.precio-input input{
    width:100%;
    border:none;
    outline:none;
    font-weight:800;
    background:transparent;
}
.icon-grid{
    grid-template-columns:repeat(3,1fr);
    gap:10px;
    max-height:260px;
    overflow-y:auto;
}
.icon-option{
    border:1px solid #e5e9f2;
    border-radius:12px;
    padding:10px;
    background:#fff;
    cursor:pointer;
    display:grid;
    justify-items:center;
    gap:6px;
    transition:transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease;
}
.icon-option.active{
    border-color:#1d70b8;
    box-shadow:0 8px 18px rgba(29,112,184,0.18);
    transform:translateY(-1px);
}
.icon-thumb{
    width:48px;
    height:48px;
    background-size:contain;
    background-position:center;
    background-repeat:no-repeat;
    border-radius:10px;
    background-color:#f5f7fb;
    border:1px solid #e5e9f2;
}
.btn-crear{
    width:100%;
    margin-top:12px;
    padding:12px 14px;
    border:none;
    border-radius:12px;
    background:linear-gradient(135deg,#1d70b8,#155488);
    color:#fff;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 10px 22px rgba(29,112,184,0.18);
    transition:transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease;
}
.btn-crear:disabled{
    opacity:0.6;
    box-shadow:none;
    cursor:not-allowed;
}
.icon-search{
    width:100%;
    margin-bottom:10px;
    padding:10px 12px;
    border:1px solid var(--border);
    border-radius:10px;
    background:#f5f7fb;
}

#reportes{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    gap:14px;
    padding:14px 20px 24px;
    background:var(--surface);
}

@media (min-width: 601px){
    /* En desktop la hoja no debe comportarse como bottom-sheet */
    #reportes .reportes-sheet{
        display:contents;
        transform:none !important;
    }
    #reportes .sheet-handle,
    #reportes .close-reportes{
        display:none;
    }
}
.reporte-card{
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:12px;
    box-shadow:var(--shadow);
    padding:14px;
}
.reporte-card h3{
    margin:0 0 10px;
    font-size:16px;
    color:var(--text);
}
.reporte-card table{
    width:100%;
    border-collapse:collapse;
    font-size:13px;
}
.reporte-card{
    overflow:hidden;
}
.reporte-card .reportes-toolbar{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    align-items:center;
    margin:10px 0 12px;
}
.reportes-toolbar input,
.reportes-toolbar select{
    height:38px;
    padding:8px 10px;
    border:1px solid var(--border);
    border-radius:10px;
    background:var(--field-bg);
    color:var(--text);
    font-family:inherit;
}
.reportes-toolbar #filtroAvisoTexto{
    flex:1;
    min-width:180px;
}
.toolbar-dates{
    display:flex;
    gap:8px;
}
.btnToolbar{
    width:auto;
    padding:9px 12px;
    border:none;
    border-radius:10px;
    background:#233447;
    color:#fff;
    font-weight:700;
    cursor:pointer;
}
.btnToolbar:hover{
    background:#182531;
}
.aviso-img-link{
    color:var(--primary);
    text-decoration:underline;
    font-weight:700;
    cursor:pointer;
}

/* Vista visitante: solo Avisos */
.role-visitante .reporte-horizontal,
.role-visitante .reporte-vertical{
    display:none;
}
.reporte-card th,
.reporte-card td{
    border-bottom:1px solid var(--border);
    padding:8px;
    text-align:left;
}
.aviso-meta-row td{
    background:var(--row-alt-bg);
    color:var(--muted);
    font-size:12px;
    padding:10px 8px;
}
.aviso-meta{
    display:flex;
    flex-wrap:wrap;
    gap:10px 16px;
}
.aviso-meta strong{
    color:var(--text);
}
.reporte-card th{
    background:var(--table-header-bg);
    color:var(--muted);
    font-weight:700;
}
.reporte-card tbody tr:last-child td{
    border-bottom:none;
}
.reporte-card td.empty{
    text-align:center;
    color:var(--muted);
}

.hidden{
    display:none!important;
}

.mobile-banner{
    position:fixed;
    top:80px;
    right:12px;
    background:var(--panel-glass-strong);
    backdrop-filter:blur(6px);
    padding:6px 10px;
    border-radius:12px;
    font-weight:700;
    color:var(--primary);
    box-shadow:0 6px 16px rgba(0,0,0,0.1);
    z-index:1500;
    display:none;
}

.aviso-thumb{
    margin-top:8px;
}
.aviso-thumb img{
    max-width:120px;
    max-height:80px;
    border-radius:8px;
    display:block;
    transition:transform 200ms ease;
}
.btnVerFoto{
    margin-top:6px;
    width:auto;
    background:#1d70b8;
    color:#fff;
    border:none;
    border-radius:8px;
    padding:6px 10px;
    cursor:pointer;
}
.btnVerFoto:hover{
    background:#155488;
}
.popup-aviso-estado .leaflet-popup-content{
    margin:12px 14px;
}
.aviso-estado-popup{
    min-width:220px;
    font-size:13px;
    color:var(--text);
}
.aviso-estado-title{
    font-weight:800;
    margin-bottom:6px;
}
.aviso-estado-desc{
    color:var(--muted);
    margin-bottom:10px;
    font-size:12px;
}
.aviso-estado-actions{
    display:flex;
    gap:10px;
}
.aviso-estado-btn{
    flex:1;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid var(--border);
    background:var(--field-bg);
    cursor:pointer;
    font-weight:700;
}
.aviso-estado-btn.active{
    background:rgba(29,112,184,0.1);
    border-color:var(--primary);
    color:var(--primary);
}
.aviso-estado-btn:hover{
    border-color:var(--primary);
}
.foto-fullscreen{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:4000;
    opacity:0;
    pointer-events:none;
    transition:opacity 200ms ease;
}
.foto-fullscreen.active{
    opacity:1;
    pointer-events:auto;
}
.foto-fullscreen img{
    max-width:80%;
    max-height:80%;
    border-radius:12px;
    box-shadow:0 20px 60px rgba(0,0,0,0.35);
}

.modal{
    position:fixed;
    inset:0;
    background:rgba(15,23,42,0.45);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:2000;
}
.modal-content{
    background:var(--panel);
    border-radius:12px;
    padding:18px;
    width:340px;
    box-shadow:0 20px 50px rgba(0,0,0,0.25);
}
.modal-content h3{
    margin:0 0 12px;
}
.modal-content label{
    display:block;
    font-size:13px;
    color:var(--muted);
    margin:10px 0 4px;
}
.modal-content select,
.modal-content textarea,
.modal-content input[type="text"],
.modal-content input[type="file"]{
    width:100%;
    border:1px solid var(--border);
    border-radius:10px;
    padding:8px 10px;
    background:var(--field-bg);
    color:var(--text);
    font-family:inherit;
}
.modal-content textarea{resize:vertical;}
.modal-actions{
    display:flex;
    justify-content:flex-end;
    gap:10px;
    margin-top:12px;
}
.modal-actions button{
    width:auto;
    margin-top:0;
}
.ubica{
    margin-top:8px;
    font-size:12px;
    color:var(--muted);
}

#btnReportar{
    margin-top:8px;
}

#loginOverlay{
    position:fixed;
    inset:0;
    background:var(--bg);
    display:flex;
    z-index:3000;
}
.login-layout{
    display:grid;
    grid-template-columns:1.4fr 1fr;
    width:100%;
    height:100%;
}
.login-hero{
    background:url(" ../src/assets/login-bg.png") center/cover no-repeat;
}
.login-card{
    background:var(--panel);
    padding:48px;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    gap:16px;
    box-shadow:0 20px 60px rgba(0,0,0,0.18);
}
.login-logo{
    max-width:180px;
    margin:0 auto;
}
.login-card h2{
    margin:0;
}
.login-card p{
    margin:0;
    color:var(--muted);
}
.login-card form{
    display:grid;
    gap:12px;
    width:100%;
}
.login-card label{
    font-size:13px;
    color:var(--muted);
}
.login-card input{
    width:100%;
    height:44px;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid var(--border);
    background:var(--field-bg);
    color:var(--text);
}
.login-card button{
    width:auto;
    margin-top:0;
}
.login-actions{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
}
.login-link{
    color:var(--primary);
    font-weight:600;
}
.login-hint{
    display:block;
    margin-top:4px;
    color:var(--muted);
    font-size:12px;
}

@media (max-width: 900px){
    .leaflet-control-container .leaflet-top.leaflet-left{
        margin-left:12px;
        margin-top:200px;
    }
    .legend{
        right:10px;
        bottom:14px;
    }
    #reportes{
        padding:10px 12px 16px;
        grid-template-columns:1fr;
    }
    #loginOverlay .login-layout{
        grid-template-columns:1fr;
    }
    .login-hero{display:none;}
    .mobile-banner{display:block;}
}

@media (max-width: 600px){
    #reportes{
        display:none;
    }
    #reportes.mobile-visible{
        display:block;
        position:fixed;
        inset:0;
        background:rgba(15,23,42,0.18);
        z-index:2200;
        overflow:hidden;
    }
    #reportes .reportes-sheet{
        position:absolute;
        left:0; right:0; bottom:0;
        background:var(--panel);
        border-radius:16px 16px 0 0;
        box-shadow:0 -8px 30px rgba(0,0,0,0.18);
        max-height:85vh;
        padding:14px 12px 24px;
        transform:translateY(100%);
        transition:transform 220ms ease;
    }
    #reportes.mobile-visible .reportes-sheet{
        transform:translateY(0);
    }
    .sheet-handle{
        width:48px;
        height:5px;
        background:#cfd6e0;
        border-radius:99px;
        margin:0 auto 10px;
    }
    #reportes.mobile-visible .reporte-card{
        margin-top:12px;
    }
    .close-reportes{
        display:block;
        margin:0 auto 6px;
        padding:10px 14px;
        border:none;
        border-radius:10px;
        background:#233447;
        color:#fff;
        font-weight:700;
        width:120px;
    }
    .reporte-avisos .reportes-toolbar{
        position:sticky;
        top:0;
        background:var(--panel);
        padding-top:6px;
        z-index:5;
    }
    #map{
        position:fixed;
        top:0;
        left:0;
        right:0;
        bottom:0;
        height:auto;
        margin-top:0;
    }
    .map-floating-controls{
        left:12px;
        right:12px;
        top:12px;
    }
    body.dash-shell .map-floating-controls{
        left:12px;
        right:12px;
    }
    .map-floating-row{
        width:100%;
    }
    .map-floating-actions{
        width:100%;
    }
    .map-floating-btn{
        flex:1;
        text-align:center;
    }
    .map-floating-panel{
        width:min(360px, calc(100vw - 24px));
    }
    .icon-grid{
        grid-template-columns:repeat(2,1fr);
        max-height:220px;
    }
    .popup-crear{
        min-width:260px;
        padding:8px;
    }
    .legend{
        font-size:12px;
    }
}
