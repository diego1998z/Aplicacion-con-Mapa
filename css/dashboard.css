:root{
  --dash-bg:#0b3b48;
  --dash-accent:#2fe2c2;
  --dash-card:#ffffff;
  --dash-muted:#e9eef1;
  --dash-muted2:#d7e0e4;
  --dash-text:#0b2230;
}

.dashboard-overlay{
  position:fixed;
  inset:0;
  z-index:2500;
  background:var(--bg);
  display:flex;
  overflow:hidden;
}

.dashboard-overlay.dash-mode-mapa,
.dashboard-overlay.dash-mode-reportes{
  background:transparent;
  pointer-events:none;
}
.dashboard-overlay.dash-mode-mapa .dash-sidebar,
.dashboard-overlay.dash-mode-reportes .dash-sidebar{
  pointer-events:auto;
}
.dashboard-overlay.dash-mode-mapa .dash-main,
.dashboard-overlay.dash-mode-reportes .dash-main{
  display:none;
}

.dash-sidebar{
  width:280px;
  min-width:260px;
  background:var(--dash-bg);
  color:#fff;
  padding:28px 22px;
  display:flex;
  flex-direction:column;
  gap:22px;
}

.dash-brand{
  display:flex;
  align-items:center;
  gap:10px;
  padding:8px 6px;
}
.dash-logo{
  font-weight:900;
  letter-spacing:0.08em;
  font-size:22px;
  color:var(--dash-accent);
}

.dash-user{
  display:flex;
  align-items:center;
  gap:14px;
  padding:14px 10px;
  border-radius:18px;
  background:rgba(255,255,255,0.06);
}
.dash-avatar{
  width:62px;
  height:62px;
  border-radius:50%;
  background:linear-gradient(135deg, rgba(47,226,194,0.9), rgba(33,151,196,0.9));
  display:grid;
  place-items:center;
  font-weight:900;
  letter-spacing:0.06em;
}
.dash-user-meta{min-width:0;}
.dash-welcome{opacity:0.85;font-size:12px;}
.dash-name{font-weight:800;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.dash-email{opacity:0.75;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

.dash-nav{
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:6px;
}
.dash-link{
  width:100%;
  text-align:left;
  padding:12px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.12);
  background:transparent;
  color:#fff;
  font-weight:700;
  cursor:pointer;
  transition:background .18s ease, border-color .18s ease, transform .18s ease;
}
.dash-link:hover{background:rgba(255,255,255,0.08); transform:translateY(-1px);}
.dash-link.active{
  background:rgba(47,226,194,0.12);
  border-color:rgba(47,226,194,0.35);
  color:#eafffb;
}
.role-visitante .dash-link[data-dash="reportes"]{
  display:none;
}
.role-visitante [data-dash-go="reportes"]{
  display:none;
}
.dash-link:disabled{
  opacity:0.4;
  cursor:not-allowed;
}

.dash-logout{
  margin-top:auto;
  width:100%;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.18);
  background:rgba(0,0,0,0.18);
  color:#fff;
  font-weight:800;
  cursor:pointer;
}
.dash-logout:hover{background:rgba(0,0,0,0.24);}

.dash-main{
  flex:1;
  padding:36px 38px;
  overflow:auto;
  color:var(--dash-text);
}

.dash-top{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:16px;
  margin-bottom:18px;
}
.dash-entity{font-weight:800;}
.dash-msg{color:#4a5b66;margin-top:6px;}

.dash-title h1{
  margin:0 0 18px;
  font-size:22px;
}
.dash-title h1 span{color:#6a7a85;font-weight:700;}

.dash-grid{
  display:grid;
  grid-template-columns: 2fr 1fr;
  gap:20px;
}

.dash-card{
  background:var(--dash-card);
  border-radius:22px;
  padding:22px 22px;
  box-shadow:0 14px 32px rgba(11,34,48,0.08);
  border:1px solid rgba(11,34,48,0.06);
}

.dash-card--primary{
  background:#ffd84c;
  color:#0b2230;
}
.dash-card--secondary{
  background:var(--dash-muted2);
}
.dash-card--muted{
  background:var(--dash-muted);
}

.dash-card-head{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
}
.dash-card-kicker{
  font-weight:800;
  font-size:13px;
  color:rgba(11,34,48,0.85);
}
.dash-card-go{
  width:38px;
  height:38px;
  border-radius:999px;
  border:2px solid rgba(11,34,48,0.7);
  background:rgba(255,255,255,0.55);
  font-weight:900;
  cursor:pointer;
}
.dash-card-go:hover{background:#fff;}

.dash-card-value{
  font-size:44px;
  font-weight:900;
  margin-top:14px;
  line-height:1;
}
.dash-card-unit{font-size:18px; font-weight:900; margin-left:6px; opacity:0.9;}
.dash-card-sub{color:rgba(11,34,48,0.72); font-weight:700; margin-top:10px; font-size:13px;}
.dash-card-money{font-size:32px; font-weight:900; margin-top:6px;}

.dash-card-split{
  margin-top:12px;
  display:flex;
  align-items:center;
  gap:16px;
}
.dash-card-big{
  font-size:52px;
  font-weight:900;
  line-height:1;
}

.dash-avisos-expanded{
  max-width:1100px;
}

/* Inversion */
.inv-grid{
  display:grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap:18px;
  margin-bottom:20px;
}
.inv-card{
  background:var(--dash-card);
  border-radius:18px;
  padding:18px 18px;
  border:1px solid rgba(11,34,48,0.08);
  box-shadow:0 12px 26px rgba(11,34,48,0.08);
}
.inv-card-title{
  font-weight:800;
  font-size:12px;
  color:rgba(11,34,48,0.7);
}
.inv-card-value{
  margin-top:8px;
  font-size:22px;
  font-weight:900;
}
.inv-card-sub{
  margin-top:6px;
  font-size:12px;
  color:rgba(11,34,48,0.6);
  font-weight:800;
}
.inv-card--total{background:#e6f0f5;}
.inv-card--ok{background:#e8f5ee;}
.inv-card--warn{background:#fff2e6;}
.inv-card--danger{background:#fdebea;}
.inv-scope{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  margin-bottom:14px;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(11,34,48,0.08);
  background:#fff;
}
.inv-scope-label{
  font-size:13px;
  color:#0b2230;
  font-weight:800;
}
.inv-scope-select{
  display:flex;
  align-items:center;
  gap:10px;
}
.inv-scope-select label{
  font-size:12px;
  font-weight:800;
  color:rgba(11,34,48,0.6);
}
.inv-scope-select select{
  border:1px solid rgba(11,34,48,0.12);
  border-radius:10px;
  padding:8px 10px;
  font-size:12px;
  font-weight:800;
  background:#f6f8fb;
  color:#0b2230;
}

.inv-block{
  background:var(--dash-card);
  border-radius:18px;
  padding:18px;
  border:1px solid rgba(11,34,48,0.08);
  box-shadow:0 12px 26px rgba(11,34,48,0.08);
  margin-bottom:20px;
}
.inv-block h3{
  margin:0 0 14px;
  font-size:14px;
  font-weight:900;
}
.inv-bars{
  display:flex;
  flex-direction:column;
  gap:12px;
}
.inv-bar{
  display:grid;
  grid-template-columns:140px 1fr 120px;
  gap:12px;
  align-items:center;
  font-size:12px;
  font-weight:800;
}
.inv-bar-track{
  height:12px;
  background:#edf1f5;
  border-radius:999px;
  overflow:hidden;
}
.inv-bar-fill{
  height:100%;
  width:0%;
  border-radius:999px;
  transition:width 0.25s ease;
}
.inv-bar-fill--blue{background:#2f6fed;}
.inv-bar-fill--gold{background:#f7a800;}
.inv-bar-fill--green{background:#2fa84f;}

.inv-table{
  width:100%;
  border-collapse:collapse;
  font-size:12px;
}
.inv-table th,
.inv-table td{
  padding:10px 8px;
  border-bottom:1px solid rgba(11,34,48,0.08);
  text-align:left;
}
.inv-table th{
  color:#6a7a85;
  font-weight:900;
  text-transform:uppercase;
  font-size:11px;
}
.inv-price-cell{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}
.inv-price-cell span{
  white-space:nowrap;
}
.inv-edit-btn{
  border:1px solid rgba(11,34,48,0.18);
  background:#f2f6fa;
  color:#0b2230;
  border-radius:999px;
  padding:4px 10px;
  font-size:11px;
  font-weight:800;
  cursor:pointer;
}
.inv-edit-btn:hover{filter:brightness(0.98);}
.inv-summary{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.inv-summary-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px 12px;
  border-radius:12px;
  background:#f6f8fb;
  font-weight:800;
}
.inv-summary-row--total{
  background:#f7edd1;
}

.apu-panel{
  display:flex;
  flex-direction:column;
  gap:16px;
}
.apu-controls{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:16px;
}
.apu-control label{
  display:block;
  font-size:12px;
  color:var(--muted);
  margin-bottom:6px;
}
.apu-control select,
.apu-control input{
  width:100%;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px 12px;
  background:var(--field-bg);
  color:var(--text);
  font-family:inherit;
}
.apu-meta{
  display:flex;
  flex-wrap:wrap;
  gap:12px 18px;
  font-size:12px;
  color:var(--muted);
}
.apu-table-wrap{
  border:1px solid var(--border);
  border-radius:14px;
  overflow:auto;
  background:var(--panel);
}
.apu-table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
.apu-table th,
.apu-table td{
  text-align:left;
  padding:10px 12px;
  border-bottom:1px solid var(--border);
}
.apu-table th{
  background:var(--field-bg);
  color:var(--muted);
  font-weight:700;
}
.apu-table tbody tr:last-child td{
  border-bottom:none;
}
.apu-table tbody tr.is-selected{
  background:rgba(29,112,184,0.08);
}
.apu-detail{
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  background:var(--panel);
}
.apu-detail-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:12px;
}
.apu-detail-head h3{
  margin:0;
  font-size:16px;
}
.apu-detail-head span{
  color:var(--muted);
  font-size:12px;
}
.apu-detail-section{
  margin-bottom:16px;
}
.apu-detail-section:last-child{
  margin-bottom:0;
}
.apu-detail-section h4{
  margin:0 0 8px;
  font-size:13px;
}
.apu-detail-table{
  width:100%;
  border-collapse:collapse;
  font-size:12px;
}
.apu-detail-table th,
.apu-detail-table td{
  text-align:left;
  padding:8px 10px;
  border-bottom:1px solid var(--border);
}
.apu-detail-table th{
  background:var(--field-bg);
  color:var(--muted);
  font-weight:700;
}
.apu-detail-table tbody tr:last-child td{
  border-bottom:none;
}
.apu-detail-table tfoot td{
  background:var(--field-bg);
  font-weight:700;
  border-top:1px solid var(--border);
}
.apu-detail-table tfoot td:last-child{
  text-align:right;
}
.apu-empty{
  color:var(--muted);
  font-size:12px;
  padding:6px 2px;
}

@media (max-width: 1100px){
  .inv-grid{grid-template-columns: repeat(2, minmax(0, 1fr));}
  .inv-bar{grid-template-columns:120px 1fr 90px;}
  .apu-controls{grid-template-columns:1fr;}
}
@media (max-width: 720px){
  .inv-grid{grid-template-columns:1fr;}
  .inv-scope{
    flex-direction:column;
    align-items:flex-start;
  }
  .inv-scope-select{
    width:100%;
  }
  .inv-scope-select select{
    width:100%;
  }
}
.dash-avisos-expanded .reportes-toolbar{
  flex-wrap:wrap;
}

.dash-placeholder{
  background:#fff;
  border-radius:22px;
  padding:22px;
  border:1px solid rgba(11,34,48,0.06);
  box-shadow:0 14px 32px rgba(11,34,48,0.08);
  max-width:720px;
}
.dash-placeholder p{
  margin:10px 0 0;
  color:#4a5b66;
  font-weight:600;
  line-height:1.5;
}

.dash-page[data-dash-page="tareas"] .dash-placeholder{
  display:none;
}
.dash-page[data-dash-page="config"] .dash-placeholder{
  display:none;
}

.dash-config{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:18px;
  align-items:start;
}
.dash-config-card{
  background:var(--dash-card);
}
.dash-section-title{
  margin:0 0 12px;
  font-size:15px;
  font-weight:900;
}
.dash-form label{
  display:block;
  margin:10px 0 6px;
  font-size:12px;
  font-weight:800;
  color:rgba(11,34,48,0.74);
}
.dash-form input[type="text"],
.dash-form input[type="number"]{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(11,34,48,0.12);
  background:#fff;
  font-weight:700;
  outline:none;
}
.dash-form input:disabled{
  opacity:0.7;
  background:#f2f5f7;
}
.dash-grid-2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.dash-actions-row{
  display:flex;
  gap:10px;
  align-items:center;
  margin-top:14px;
  flex-wrap:wrap;
}
.dash-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  padding:10px 14px;
  border-radius:12px;
  border:1px solid rgba(11,34,48,0.12);
  background:#0c426a;
  color:#fff;
  font-weight:900;
  cursor:pointer;
}
.dash-btn:hover{filter:brightness(1.05);}
.dash-btn--ghost{
  background:#fff;
  color:#0c426a;
}
.dash-file{
  position:relative;
  overflow:hidden;
}
.dash-file input[type="file"]{
  position:absolute;
  inset:0;
  opacity:0;
  cursor:pointer;
}
.dash-help{
  margin-top:10px;
  font-size:12px;
  color:#4a5b66;
  font-weight:700;
}

.dash-toggle{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:14px;
  padding:10px 0;
  border-bottom:1px solid rgba(11,34,48,0.08);
}
.dash-toggle:last-child{border-bottom:none;}
.dash-toggle-title{font-weight:900;}
.dash-toggle-sub{margin-top:4px; color:#4a5b66; font-weight:700; font-size:12px;}

/* Switch */
.switch{position:relative; display:inline-block; width:50px; height:28px;}
.switch input{opacity:0; width:0; height:0;}
.slider{
  position:absolute;
  cursor:pointer;
  inset:0;
  background:#cbd5db;
  transition:.18s;
  border-radius:999px;
}
.slider:before{
  position:absolute;
  content:"";
  height:22px;
  width:22px;
  left:3px;
  top:3px;
  background:white;
  transition:.18s;
  border-radius:999px;
  box-shadow:0 6px 14px rgba(0,0,0,0.18);
}
.switch input:checked + .slider{
  background:rgba(47,226,194,0.65);
}
.switch input:checked + .slider:before{
  transform:translateX(22px);
}

/* Tema oscuro (simple) */
body.theme-dark{
  --bg:#0b1220;
  --panel:#0f1b2d;
  --text:#e8eef7;
  --muted:#a7b3c7;
  --border: rgba(255,255,255,0.12);
  --surface: rgba(255,255,255,0.03);
  --panel-glass: rgba(15,27,45,0.92);
  --panel-glass-strong: rgba(15,27,45,0.96);
  --field-bg: rgba(255,255,255,0.06);
  --field-bg-focus: rgba(255,255,255,0.10);
  --table-header-bg: rgba(255,255,255,0.06);
  --row-alt-bg: rgba(255,255,255,0.04);
  --shadow: 0 14px 34px rgba(0,0,0,0.35);
  --dash-card: var(--panel);
  --dash-muted: rgba(255,255,255,0.06);
  --dash-muted2: rgba(255,255,255,0.10);
  --dash-text: var(--text);
}
body.theme-dark{
  background:radial-gradient(circle at 10% 20%, #0a1323 0, #0b1220 55%, #08101c 100%);
}
body.theme-dark .dash-main{color:#e8eef7;}
body.theme-dark .dash-card{border-color:rgba(255,255,255,0.10);}
body.theme-dark .dash-card--muted{background:rgba(255,255,255,0.06);}
body.theme-dark .dash-card--secondary{background:rgba(255,255,255,0.10);}
body.theme-dark .dash-msg{color:var(--muted);}
body.theme-dark .dash-title h1 span{color:var(--muted);}
body.theme-dark .dash-card:not(.dash-card--primary) .dash-card-kicker{color:rgba(255,255,255,0.86);}
body.theme-dark .dash-card:not(.dash-card--primary) .dash-card-sub{color:var(--muted);}
body.theme-dark .dash-placeholder{
  background:var(--dash-card);
  border-color:var(--border);
  box-shadow:var(--shadow);
}
body.theme-dark .dash-placeholder p{color:var(--muted);}
body.theme-dark .dash-help{color:var(--muted);}
body.theme-dark .dash-toggle{border-bottom:1px solid var(--border);}
body.theme-dark .dash-card-go{border-color:rgba(255,255,255,0.65); color:#0b2230;}
body.theme-dark .dash-form input[type="text"],
body.theme-dark .dash-form input[type="number"]{
  background:rgba(255,255,255,0.08);
  border-color:rgba(255,255,255,0.12);
  color:#e8eef7;
}
body.theme-dark .dash-form input:disabled{background:rgba(255,255,255,0.04);}
body.theme-dark .dash-form label{color:rgba(255,255,255,0.72);}
body.theme-dark .dash-toggle-sub{color:rgba(255,255,255,0.72);}
body.theme-dark .dash-btn--ghost{
  background:rgba(255,255,255,0.08);
  border-color:rgba(255,255,255,0.12);
  color:#e8eef7;
}
body.theme-dark .slider{background:rgba(255,255,255,0.18);}

/* Leaflet popups en tema oscuro */
body.theme-dark .leaflet-popup-content-wrapper,
body.theme-dark .leaflet-popup-tip{
  background:var(--panel);
  color:var(--text);
}
body.theme-dark .leaflet-popup-content-wrapper{
  box-shadow:0 18px 45px rgba(0,0,0,0.45);
}
body.theme-dark .popup-crear{color:var(--text);}
body.theme-dark .popup-tabs .tab-btn{
  background:var(--field-bg);
  border-color:var(--border);
  color:var(--text);
}
body.theme-dark .estado-option,
body.theme-dark .icon-option,
body.theme-dark .precio-input{
  background:rgba(255,255,255,0.06);
  border-color:var(--border);
  color:var(--text);
}
body.theme-dark .fecha-row input{
  background:rgba(255,255,255,0.06);
  color:var(--text);
}
body.theme-dark .icon-thumb{
  background-color:rgba(255,255,255,0.08);
  border-color:var(--border);
}
body.theme-dark .icon-search{
  background:rgba(255,255,255,0.06);
  color:var(--text);
}

/* Cuando el sidebar del dashboard esta activo, desplazar la UI principal en desktop */
@media (min-width: 901px){
  body.dash-shell .topbar{
    left:280px;
    right:0;
    width:auto;
  }
  body.dash-shell #map{
    margin-left:280px;
    width:calc(100% - 280px);
  }
  body.dash-shell #sidebar{
    left:300px;
  }
  body.dash-shell #reportes{
    margin-left:280px;
    width:calc(100% - 280px);
  }
  body.dash-shell .mobile-search{
    left:280px;
    right:0;
  }
}

/* Responsivo */
@media (max-width: 900px){
  .dashboard-overlay{flex-direction:column;}
  .dash-sidebar{
    width:auto;
    min-width:0;
    padding:18px 16px;
  }
  .dash-nav{flex-direction:row; flex-wrap:wrap;}
  .dash-link{width:auto; flex:1 1 40%;}
  .dash-main{padding:18px 16px;}
  .dash-grid{grid-template-columns:1fr; }
  .dash-config{grid-template-columns:1fr;}
  .dash-grid-2{grid-template-columns:1fr;}
}
